<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SipariÅŸ DetayÄ± - BÃ¼yÃ¼lÃ¼ Sepet</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <!-- Kar Taneleri -->
    <div class="snowflakes" aria-hidden="true">
        <div class="snowflake">â…</div>
        <div class="snowflake">â†</div>
        <div class="snowflake">â…</div>
        <div class="snowflake">â†</div>
        <div class="snowflake">â…</div>
        <div class="snowflake">â†</div>
        <div class="snowflake">â…</div>
        <div class="snowflake">â†</div>
        <div class="snowflake">â…</div>
        <div class="snowflake">â†</div>
    </div>

    <!-- Navigasyon -->
    <header>
        <div class="navbar">
            <div class="logo">
                <h1><a href="/" style="text-decoration:none; color:inherit;">ğŸ BÃ¼yÃ¼lÃ¼ Sepet âœ¨</a></h1>
            </div>
            <div class="search-bar-container">
                <form action="/urunler" method="GET" class="search-form">
                    <input type="text" name="search" placeholder="ÃœrÃ¼n ara..." class="search-input" id="searchInput">
                    <button type="submit" class="search-button">ğŸ”</button>
                </form>
                <div id="searchSuggestions" class="search-suggestions"></div>
            </div>
            <button class="menu-toggle" onclick="toggleMenu()">â˜°</button>
            <div class="nav-links" id="navMenu">
                <a href="/">Ana Sayfa</a>
                <a href="/urunler">ÃœrÃ¼nler</a>
                <a href="/urunler?kategori=cocuk" class="kids-link">ğŸˆ Ã‡ocuklar Ä°Ã§in</a>
                <a href="/hakkimizda">HakkÄ±mÄ±zda</a>
                <a href="/iletisim">Ä°letiÅŸim</a>
                <a href="/sepet" class="cart-fab">ğŸ›’ Sepet</a>
                <a href="/favoriler">â¤ï¸ Favoriler</a>
                <a href="/support">ğŸ’¬ Destek</a>
                <a href="/game" class="forest-link">ğŸŒ² BÃ¼yÃ¼lÃ¼ Orman</a>
                <a href="/profile">ğŸ‘¤ {{ current_user.name.split()[0][0]}}.{{ current_user.name.split()[1][0] if current_user.name.split()|length > 1 else 'U' }}</a>
                <a href="/logout">ğŸšª Ã‡Ä±kÄ±ÅŸ</a>
            </div>
        </div>
    </header>

    <!-- SipariÅŸ DetayÄ± -->
    <main class="order-detail-page">
        <div class="container">
            <!-- BaÅŸarÄ± MesajÄ± -->
            <div class="success-banner">
                <div class="success-icon">âœ¨ğŸ‰âœ¨</div>
                <h1>SipariÅŸiniz AlÄ±ndÄ±!</h1>
                <p>TeÅŸekkÃ¼r ederiz! SipariÅŸiniz baÅŸarÄ±yla oluÅŸturuldu.</p>
            </div>

            <!-- Takip NumarasÄ± -->
            <div class="tracking-section">
                <div class="tracking-number">
                    <span class="tracking-label">Takip NumarasÄ±:</span>
                    <strong class="tracking-code">{{ siparis.tracking_number }}</strong>
                </div>
                <p class="tracking-info">Bu numarayÄ± kullanarak sipariÅŸinizi takip edebilirsiniz.</p>
            </div>

            <div class="order-detail-layout">
                <!-- Sol: SipariÅŸ Bilgileri -->
                <div class="order-left">
                    <!-- SipariÅŸ Durumu -->
                    <div class="order-section">
                        <h2>ğŸ“¦ SipariÅŸ Durumu</h2>
                        <div class="order-status">
                            {% if siparis.status == 'Teslim Edildi' %}
                                <div class="status-badge status-delivered">âœ… {{ siparis.status }}</div>
                            {% elif siparis.status == 'Kargoya Verildi' %}
                                <div class="status-badge status-shipped">ğŸšš {{ siparis.status }}</div>
                            {% elif siparis.status == 'HazÄ±rlanÄ±yor' %}
                                <div class="status-badge status-preparing">ğŸ“¦ {{ siparis.status }}</div>
                            {% else %}
                                <div class="status-badge status-pending">â³ {{ siparis.status }}</div>
                            {% endif %}
                        </div>

                        <!-- SipariÅŸ Zaman Ã‡izelgesi -->
                        <div class="order-timeline">
                            <div class="timeline-item completed">
                                <div class="timeline-icon">âœ…</div>
                                <div class="timeline-content">
                                    <div class="timeline-title">SipariÅŸ AlÄ±ndÄ±</div>
                                    <div class="timeline-date">{{ siparis.order_date.strftime('%d.%m.%Y %H:%M') }}</div>
                                </div>
                            </div>

                            <div class="timeline-item {% if siparis.status in ['HazÄ±rlanÄ±yor', 'Kargoya Verildi', 'Teslim Edildi'] %}completed{% endif %}">
                                <div class="timeline-icon">{% if siparis.status in ['HazÄ±rlanÄ±yor', 'Kargoya Verildi', 'Teslim Edildi'] %}âœ…{% else %}â³{% endif %}</div>
                                <div class="timeline-content">
                                    <div class="timeline-title">HazÄ±rlanÄ±yor</div>
                                    <div class="timeline-date">SipariÅŸiniz hazÄ±rlanÄ±yor</div>
                                </div>
                            </div>

                            <div class="timeline-item {% if siparis.status in ['Kargoya Verildi', 'Teslim Edildi'] %}completed{% endif %}">
                                <div class="timeline-icon">{% if siparis.status in ['Kargoya Verildi', 'Teslim Edildi'] %}âœ…{% else %}â³{% endif %}</div>
                                <div class="timeline-content">
                                    <div class="timeline-title">Kargoya Verildi</div>
                                    <div class="timeline-date">Tahmini 2-3 gÃ¼n</div>
                                </div>
                            </div>

                            <div class="timeline-item {% if siparis.status == 'Teslim Edildi' %}completed{% endif %}">
                                <div class="timeline-icon">{% if siparis.status == 'Teslim Edildi' %}âœ…{% else %}â³{% endif %}</div>
                                <div class="timeline-content">
                                    <div class="timeline-title">Teslim Edildi</div>
                                    <div class="timeline-date">-</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- SipariÅŸ ÃœrÃ¼nleri -->
                    <div class="order-section">
                        <h2>ğŸ›ï¸ SipariÅŸ Edilen ÃœrÃ¼nler</h2>
                        <div class="ordered-items">
                            {% for item in siparis_items %}
                                <div class="ordered-item">
                                    <div class="ordered-item-info">
                                        <span class="item-emoji">{{ item.emoji if item.emoji else 'âœ¨' }}</span>
                                        <div class="item-details">
                                            <div class="item-name">{{ item.isim }}</div>
                                            <div class="item-qty">Adet: {{ item.adet }}</div>
                                        </div>
                                    </div>
                                    <div class="item-price">
                                        {{ "%.2f"|format(item.fiyat * item.adet) }} â‚º
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    </div>

                    <!-- Teslimat Adresi -->
                    {% if adres %}
                    <div class="order-section">
                        <h2>ğŸ“ Teslimat Adresi</h2>
                        <div class="delivery-address">
                            <div class="address-name">{{ adres.full_name }}</div>
                            <div class="address-details">
                                {{ adres.address_line }}<br>
                                {{ adres.district }}, {{ adres.city }}
                                {% if adres.postal_code %}- {{ adres.postal_code }}{% endif %}
                            </div>
                            <div class="address-phone">ğŸ“ {{ adres.phone }}</div>
                        </div>
                    </div>
                    {% endif %}

                    <!-- Hediye MesajÄ± -->
                    {% if siparis.gift_message %}
                    <div class="order-section">
                        <h2>ğŸ Hediye MesajÄ±</h2>
                        <div class="gift-message-box">
                            {{ siparis.gift_message }}
                        </div>
                    </div>
                    {% endif %}
                </div>

                <!-- SaÄŸ: Ã–deme Ã–zeti -->
                <div class="order-right">
                    <div class="payment-summary">
                        <h2>ğŸ’° Ã–deme Ã–zeti</h2>

                        <div class="payment-details">
                            <div class="payment-row">
                                <span>Ara Toplam:</span>
                                <span>{{ "%.2f"|format(siparis.total + siparis.discount) }} â‚º</span>
                            </div>

                            {% if siparis.discount > 0 %}
                                <div class="payment-row discount-row">
                                    <span>Ä°ndirim:</span>
                                    <span style="color: #2ecc71;">-{{ "%.2f"|format(siparis.discount) }} â‚º</span>
                                </div>
                            {% endif %}

                            {% if siparis.total >= 170 %}
                                <div class="payment-row">
                                    <span>Kargo:</span>
                                    <span style="color: #2ecc71;">ÃœCRETSÄ°Z</span>
                                </div>
                            {% else %}
                                <div class="payment-row">
                                    <span>Kargo:</span>
                                    <span>29,90 â‚º</span>
                                </div>
                            {% endif %}

                            <div class="payment-total">
                                <span>TOPLAM:</span>
                                <strong>{{ "%.2f"|format(siparis.total + (0 if siparis.total >= 170 else 29.90)) }} â‚º</strong>
                            </div>
                        </div>

                        <!-- Sadakat PuanlarÄ± -->
                        {% if siparis.loyalty_points and siparis.loyalty_points > 0 %}
                        <div class="loyalty-points-earned">
                            <div class="points-icon">â­</div>
                            <div class="points-text">
                                <strong>{{ siparis.loyalty_points }} Puan</strong> kazandÄ±nÄ±z!
                            </div>
                        </div>
                        {% endif %}

                        <!-- Aksiyonlar -->
                        <div class="order-actions">
                            <a href="/urunler" class="btn-continue-shopping">ğŸ›ï¸ AlÄ±ÅŸveriÅŸe Devam Et</a>
                            <a href="/profile" class="btn-view-orders">ğŸ“‹ TÃ¼m SipariÅŸlerim</a>
                        </div>
                    </div>

                    <!-- YardÄ±m Kutusu -->
                    <div class="help-box">
                        <h3>â“ YardÄ±ma mÄ± ihtiyacÄ±nÄ±z var?</h3>
                        <p>SorularÄ±nÄ±z iÃ§in mÃ¼ÅŸteri hizmetlerimizle iletiÅŸime geÃ§ebilirsiniz.</p>
                        <a href="/support" class="btn-support">ğŸ’¬ Destek Al</a>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>ğŸ BÃ¼yÃ¼lÃ¼ Sepet</h3>
                <p>YÄ±lbaÅŸÄ±nÄ±n sihirli dÃ¼nyasÄ±na hoÅŸ geldiniz!</p>
            </div>
            <div class="footer-section">
                <h3>Ä°letiÅŸim</h3>
                <p>ğŸ“§ info@buyuluorman.com</p>
                <p>ğŸ“± +90 (555) 123 45 67</p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 BÃ¼yÃ¼lÃ¼ Sepet - YÄ±lbaÅŸÄ± AlÄ±ÅŸveriÅŸ MaÄŸazasÄ±. TÃ¼m haklarÄ± saklÄ±dÄ±r. âœ¨ğŸ„</p>
        </div>
    </footer>

    <script>
        function toggleMenu() {
            const menu = document.getElementById('navMenu');
            menu.classList.toggle('active');
        }
    </script>
</body>
</html>
